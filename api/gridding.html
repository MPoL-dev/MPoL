
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gridding &#8212; MPoL 0.1.dev1+g84a5d46 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=cecc2822"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/gridding';</script>
    <script src="https://buttons.github.io/buttons.js"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Images" href="images.html" />
    <link rel="prev" title="Fourier" href="fourier.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="MPoL 0.1.dev1+g84a5d46 documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="MPoL 0.1.dev1+g84a5d46 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background and prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="coordinates.html">Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier.html">Fourier</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Gridding</a></li>
<li class="toctree-l1"><a class="reference internal" href="images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="precomposed.html">Precomposed Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="train_test.html">Training and testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossval.html">Cross-validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../units-and-conventions.html">Units and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer-documentation.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/MPoL-dev/MPoL" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/api/gridding.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Gridding</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.verify_no_hermitian_pairs"><code class="docutils literal notranslate"><span class="pre">verify_no_hermitian_pairs()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.GridderBase"><code class="docutils literal notranslate"><span class="pre">GridderBase</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.GridderBase.ground_cube"><code class="docutils literal notranslate"><span class="pre">GridderBase.ground_cube</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DataAverager"><code class="docutils literal notranslate"><span class="pre">DataAverager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DataAverager.to_pytorch_dataset"><code class="docutils literal notranslate"><span class="pre">DataAverager.to_pytorch_dataset()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager"><code class="docutils literal notranslate"><span class="pre">DirtyImager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager.from_tensors"><code class="docutils literal notranslate"><span class="pre">DirtyImager.from_tensors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager.get_dirty_beam_area"><code class="docutils literal notranslate"><span class="pre">DirtyImager.get_dirty_beam_area()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager.get_dirty_image"><code class="docutils literal notranslate"><span class="pre">DirtyImager.get_dirty_image()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="module-mpol.gridding">
<span id="gridding"></span><h1>Gridding<a class="headerlink" href="#module-mpol.gridding" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="mpol.gridding.verify_no_hermitian_pairs">
<span class="sig-prename descclassname"><span class="pre">mpol.gridding.</span></span><span class="sig-name descname"><span class="pre">verify_no_hermitian_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">complexfloating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_vis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/mpol/gridding.html#verify_no_hermitian_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.verify_no_hermitian_pairs" title="Link to this definition">#</a></dt>
<dd><p>Check that the dataset does not contain Hermitian pairs. Because the sky brightness
<span class="math notranslate nohighlight">\(I_\nu\)</span> is real, the visibility function <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> is Hermitian,
meaning that</p>
<div class="math notranslate nohighlight">
\[\mathcal{V}(u, v) = \mathcal{V}^*(-u, -v).\]</div>
<p>Most datasets (e.g., those extracted from CASA) will only record one visibility
measurement per baseline and not include the duplicate Hermitian pair (to save
storage space). This routine attempts to determine if the dataset contains
Hermitian pairs or not by choosing one data point at a time and then searching the
dataset to see if its Hermitian pair exists. The routine will declare that a dataset
contains Hermitian pairs or not after it has searched <code class="docutils literal notranslate"><span class="pre">test_vis</span></code> number of data
points. If 0 Hermitian pairs have been found for all <code class="docutils literal notranslate"><span class="pre">test_vis</span></code> points, then
the dataset will be declared to have no Hermitian pairs. If <code class="docutils literal notranslate"><span class="pre">test_vis</span></code> Hermitian
pairs were found for <code class="docutils literal notranslate"><span class="pre">test_vis</span></code> points searched, then the dataset will be
declared to have Hermitian pairs. If more than 0 but fewer than <code class="docutils literal notranslate"><span class="pre">test_vis</span></code>
Hermitian pairs were found for <code class="docutils literal notranslate"><span class="pre">test_vis</span></code> points, an error will be raised.</p>
<p>Gridding objects like <a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><code class="xref py py-class docutils literal notranslate"><span class="pre">mpol.gridding.DirtyImager</span></code></a> will naturally augment an
input dataset to include the Hermitian pairs, so that images of <span class="math notranslate nohighlight">\(I_\nu\)</span>
produced with the inverse Fourier transform turn out to be real.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uu</strong> (<em>numpy array</em>) – array of u spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>vv</strong> (<em>numpy array</em>) – array of v spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>data</strong> (<em>numpy complex</em>) – array of data values</p></li>
<li><p><strong>test_vis</strong> (<em>int</em>) – the number of data points to search for Hermitian ‘matches’</p></li>
<li><p><strong>test_channel</strong> (<em>int</em>) – the index of the channel to perform the check</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if dataset does contain Hermitian pairs, <code class="docutils literal notranslate"><span class="pre">False</span></code> if not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mpol.gridding.GridderBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mpol.gridding.</span></span><span class="sig-name descname"><span class="pre">GridderBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">coords=&lt;class</span> <span class="pre">'mpol.coordinates.GridCoords'&gt;,</span> <span class="pre">uu=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">vv=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">weight=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">data_re=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">data_im=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mpol/gridding.html#GridderBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.GridderBase" title="Link to this definition">#</a></dt>
<dd><p>This class is not designed to be used directly, but rather to be subclassed.</p>
<p>Subclasses will need to implement a <cite>_grid_visibilities(self,…)</cite> method.</p>
<p>The GridderBase object uses desired image dimensions (via the <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and
<code class="docutils literal notranslate"><span class="pre">npix</span></code> arguments) to define a corresponding Fourier plane grid as a
<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> object. A pre-computed <a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> can be supplied in
lieu of <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and <code class="docutils literal notranslate"><span class="pre">npix</span></code>, but all three arguments should never be supplied
at once. For more details on the properties of the grid that is created, see the
<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> documentation.</p>
<p>Subclasses will accept “loose” <em>ungridded</em> visibility data and store the arrays to
the object as instance attributes. The input visibility data should be the set of
visibilities over the full <span class="math notranslate nohighlight">\([-u,u]\)</span> and <span class="math notranslate nohighlight">\([-v,v]\)</span> domain, and should not
contain Hermitian pairs (an error will be raised, if they are encountered).  The
visibilities can be 1d for a single continuum channel, or 2d for an image cube. If
1d, visibilities will be converted to 2d arrays of shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">nvis)</span></code>. Like the
<a class="reference internal" href="images.html#mpol.images.ImageCube" title="mpol.images.ImageCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageCube</span></code></a> class, after construction, GridderBase assumes that
you are operating with a multi-channel set of visibilities. These routines will
still work with single-channel ‘continuum’ visibilities, they will just have
<cite>nchan = 1</cite> in the first dimension of most products.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><em>GridCoords</em></a>) – an object already instantiated from the GridCoords class.
If providing this, cannot provide <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> or <code class="docutils literal notranslate"><span class="pre">npix</span></code>.</p></li>
<li><p><strong>uu</strong> (<em>numpy array</em>) – (nchan, nvis) array of u spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>vv</strong> (<em>numpy array</em>) – (nchan, nvis) array of v spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>weight</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of thermal weights.
Units of [<span class="math notranslate nohighlight">\(1/\mathrm{Jy}^2\)</span>]</p></li>
<li><p><strong>data_re</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of the real part of the
visibility measurements. Units of [<span class="math notranslate nohighlight">\(\mathrm{Jy}\)</span>]</p></li>
<li><p><strong>data_im</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of the imaginary part of the
visibility measurements. Units of [<span class="math notranslate nohighlight">\(\mathrm{Jy}\)</span>]</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="mpol.gridding.GridderBase.ground_cube">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ground_cube</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#mpol.gridding.GridderBase.ground_cube" title="Link to this definition">#</a></dt>
<dd><p>The visibility FFT cube fftshifted for plotting with <code class="docutils literal notranslate"><span class="pre">imshow</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the FFT of the
image cube, in sky plane format.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(torch.complex tensor, of shape <code class="docutils literal notranslate"><span class="pre">(nchan,</span> <span class="pre">npix,</span> <span class="pre">npix)</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mpol.gridding.DataAverager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mpol.gridding.</span></span><span class="sig-name descname"><span class="pre">DataAverager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">coords=&lt;class</span> <span class="pre">'mpol.coordinates.GridCoords'&gt;,</span> <span class="pre">uu=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">vv=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">weight=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">data_re=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]],</span> <span class="pre">data_im=numpy.ndarray[typing.Any,</span> <span class="pre">numpy.dtype[numpy.floating[typing.Any]]]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mpol/gridding.html#DataAverager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.DataAverager" title="Link to this definition">#</a></dt>
<dd><p>The DataAverager object uses desired image dimensions (via the <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and
<code class="docutils literal notranslate"><span class="pre">npix</span></code> arguments) to define a corresponding Fourier plane grid as a
<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> object. A pre-computed <a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> can be supplied in
lieu of <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and <code class="docutils literal notranslate"><span class="pre">npix</span></code>, but all three arguments should never be supplied
at once. For more details on the properties of the grid that is created, see the
<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> documentation.</p>
<p>The <a class="reference internal" href="#mpol.gridding.DataAverager" title="mpol.gridding.DataAverager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataAverager</span></code></a> object accepts “loose” <em>ungridded</em> visibility data and
stores the arrays to the object as instance attributes. The input visibility data
should be the set of visibilities over the full <span class="math notranslate nohighlight">\([-u,u]\)</span> and <span class="math notranslate nohighlight">\([-v,v]\)</span>
domain, and should not contain Hermitian pairs (an error will be raised, if they are
encountered). (Note that, unlike <a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirtyImager</span></code></a>, this class
<em>will not</em> augment the dataset to include Hermitian pairs. This is by design,
since Hermitian pairs should not be used in likelihood calculations).</p>
<p>The input visibilities can be 1d for a single continuum channel, or 2d for image
cube. If 1d, visibilities will be converted to 2d arrays of shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">nvis)</span></code>.
Like the <a class="reference internal" href="images.html#mpol.images.ImageCube" title="mpol.images.ImageCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageCube</span></code></a> class, after construction, the DataAverager
assumes that you are operating with a multi-channel set of visibilities. These
routines will still work with single-channel ‘continuum’ visibilities, they will
just have nchan = 1 in the first dimension of most products.</p>
<p>Once the DataAverager object is initialized with loose visibilities, you can average
them and export them for use in Regularized Maximum Likelihood imaging with the
<a class="reference internal" href="#mpol.gridding.DataAverager.to_pytorch_dataset" title="mpol.gridding.DataAverager.to_pytorch_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">mpol.gridding.DataAverager.to_pytorch_dataset()</span></code></a> routine.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">averager</span> <span class="o">=</span> <span class="n">gridding</span><span class="o">.</span><span class="n">DataAverager</span><span class="p">(</span>
    <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
    <span class="n">uu</span><span class="o">=</span><span class="n">uu</span><span class="p">,</span>
    <span class="n">vv</span><span class="o">=</span><span class="n">vv</span><span class="p">,</span>
    <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
    <span class="n">data_re</span><span class="o">=</span><span class="n">data_re</span><span class="p">,</span>
    <span class="n">data_im</span><span class="o">=</span><span class="n">data_im</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">dset</span> <span class="o">=</span> <span class="n">averager</span><span class="o">.</span><span class="n">to_pytorch_dataset</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><em>GridCoords</em></a>) – an object already instantiated from the GridCoords class.
If providing this, cannot provide <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> or <code class="docutils literal notranslate"><span class="pre">npix</span></code>.</p></li>
<li><p><strong>uu</strong> (<em>numpy array</em>) – (nchan, nvis) array of u spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>vv</strong> (<em>numpy array</em>) – (nchan, nvis) array of v spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>weight</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of thermal weights.
Units of [<span class="math notranslate nohighlight">\(1/\mathrm{Jy}^2\)</span>]</p></li>
<li><p><strong>data_re</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of the real part of the
visibility measurements. Units of [<span class="math notranslate nohighlight">\(\mathrm{Jy}\)</span>]</p></li>
<li><p><strong>data_im</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of the imaginary part of the
visibility measurements. Units of [<span class="math notranslate nohighlight">\(\mathrm{Jy}\)</span>]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mpol.gridding.DataAverager.to_pytorch_dataset">
<span class="sig-name descname"><span class="pre">to_pytorch_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check_visibility_scatter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_scatter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="datasets.html#mpol.datasets.GriddedDataset" title="mpol.datasets.GriddedDataset"><span class="pre">GriddedDataset</span></a></span></span><a class="reference internal" href="../_modules/mpol/gridding.html#DataAverager.to_pytorch_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.DataAverager.to_pytorch_dataset" title="Link to this definition">#</a></dt>
<dd><p>Export gridded visibilities to a PyTorch <a class="reference internal" href="datasets.html#mpol.datasets.GriddedDataset" title="mpol.datasets.GriddedDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">mpol.datasets.GriddedDataset</span></code></a>
object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>check_visibility_scatter</strong> (<em>bool</em>) – whether the routine should check the
standard deviation of visibilities in each within each <span class="math notranslate nohighlight">\(u,v\)</span> cell
(<span class="math notranslate nohighlight">\(\mathrm{cell}_{i,j}\)</span>) defined by <code class="docutils literal notranslate"><span class="pre">self.coords</span></code>. Default
is <code class="docutils literal notranslate"><span class="pre">True</span></code>. A <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> will be raised if any cell has a
scatter larger than <code class="docutils literal notranslate"><span class="pre">max_scatter</span></code>.</p></li>
<li><p><strong>max_scatter</strong> (<em>float</em>) – the maximum allowable standard deviation of visibility
values in a given <span class="math notranslate nohighlight">\(u,v\)</span> cell (<span class="math notranslate nohighlight">\(\mathrm{cell}_{i,j}\)</span>)
defined by <code class="docutils literal notranslate"><span class="pre">self.coords</span></code>. Defaults to a factor of 120%.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="datasets.html#mpol.datasets.GriddedDataset" title="mpol.datasets.GriddedDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">GriddedDataset</span></code></a> with gridded visibilities.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mpol.gridding.DirtyImager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mpol.gridding.</span></span><span class="sig-name descname"><span class="pre">DirtyImager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><span class="pre">GridCoords</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">uu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_re</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_im</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mpol/gridding.html#DirtyImager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.DirtyImager" title="Link to this definition">#</a></dt>
<dd><p>This class is mainly used for producing diagnostic “dirty” images of the
visibility data.</p>
<p>The DirtyImager object uses desired image dimensions (via the <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and
<code class="docutils literal notranslate"><span class="pre">npix</span></code> arguments) to define a corresponding Fourier plane grid as a
<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> object. A pre-computed <a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> can be supplied in
lieu of <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and <code class="docutils literal notranslate"><span class="pre">npix</span></code>, but all three arguments should never be supplied
at once. For more details on the properties of the grid that is created, see the
<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridCoords</span></code></a> documentation.</p>
<p>The <a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirtyImager</span></code></a> object accepts “loose” <em>ungridded</em> visibility data and
stores the arrays to the object as instance attributes. The input visibility data
should be the normal set of visibilities over the full <span class="math notranslate nohighlight">\([-u,u]\)</span> and
<span class="math notranslate nohighlight">\([-v,v]\)</span> domain; internally the DirtyImager will automatically augment the
dataset to include the complex conjugates, i.e. the ‘Hermitian pairs.’</p>
<p>The input visibilities can be 1d for a single continuum channel, or 2d for image
cube. If 1d, visibilities will be converted to 2d arrays of shape <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">nvis)</span></code>.
Like the <a class="reference internal" href="images.html#mpol.images.ImageCube" title="mpol.images.ImageCube"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageCube</span></code></a> class, after construction, the DirtyImager
assumes that you are operating with a multi-channel set of visibilities. These
routines will still work with single-channel ‘continuum’ visibilities, they will
just have nchan = 1 in the first dimension of most products.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">imager</span> <span class="o">=</span> <span class="n">gridding</span><span class="o">.</span><span class="n">DirtyImager</span><span class="p">(</span>
    <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
    <span class="n">uu</span><span class="o">=</span><span class="n">uu</span><span class="p">,</span>
    <span class="n">vv</span><span class="o">=</span><span class="n">vv</span><span class="p">,</span>
    <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span>
    <span class="n">data_re</span><span class="o">=</span><span class="n">data_re</span><span class="p">,</span>
    <span class="n">data_im</span><span class="o">=</span><span class="n">data_im</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">img</span><span class="p">,</span> <span class="n">beam</span> <span class="o">=</span> <span class="n">imager</span><span class="o">.</span><span class="n">get_dirty_image</span><span class="p">(</span><span class="n">weighting</span><span class="o">=</span><span class="s2">&quot;briggs&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_size</strong> (<em>float</em>) – width of a single square pixel in [arcsec]</p></li>
<li><p><strong>npix</strong> (<em>int</em>) – number of pixels in the width of the image</p></li>
<li><p><strong>coords</strong> (<a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><em>GridCoords</em></a>) – an object already instantiated from the GridCoords class.
If providing this, cannot provide <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> or <code class="docutils literal notranslate"><span class="pre">npix</span></code>.</p></li>
<li><p><strong>uu</strong> (<em>numpy array</em>) – (nchan, nvis) array of u spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>vv</strong> (<em>numpy array</em>) – (nchan, nvis) array of v spatial frequency coordinates.
Units of [<span class="math notranslate nohighlight">\(\lambda\)</span>]</p></li>
<li><p><strong>weight</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of thermal weights.
Units of [<span class="math notranslate nohighlight">\(1/\mathrm{Jy}^2\)</span>]</p></li>
<li><p><strong>data_re</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of the real part of the
visibility measurements. Units of [<span class="math notranslate nohighlight">\(\mathrm{Jy}\)</span>]</p></li>
<li><p><strong>data_im</strong> (<em>2d numpy array</em>) – (nchan, nvis) array of the imaginary part of the
visibility measurements. Units of [<span class="math notranslate nohighlight">\(\mathrm{Jy}\)</span>]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mpol.gridding.DirtyImager.from_tensors">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="coordinates.html#mpol.coordinates.GridCoords" title="mpol.coordinates.GridCoords"><span class="pre">GridCoords</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">uu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><span class="pre">DirtyImager</span></a></span></span><a class="reference internal" href="../_modules/mpol/gridding.html#DirtyImager.from_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.DirtyImager.from_tensors" title="Link to this definition">#</a></dt>
<dd><p><a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><code class="xref py py-class docutils literal notranslate"><span class="pre">mpol.gridding.DirtyImager</span></code></a> is written internally in numpy. However,
one may wish to use <a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><code class="xref py py-class docutils literal notranslate"><span class="pre">mpol.gridding.DirtyImager</span></code></a> to image residual
visibilities, which are commonly of type <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code>. This
classmethod converts the tensors to numpy arrays and instantiates a
<a class="reference internal" href="#mpol.gridding.DirtyImager" title="mpol.gridding.DirtyImager"><code class="xref py py-class docutils literal notranslate"><span class="pre">mpol.gridding.DirtyImager</span></code></a> instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mpol.gridding.DirtyImager.get_dirty_beam_area">
<span class="sig-name descname"><span class="pre">get_dirty_beam_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ntheta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_channel_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mpol/gridding.html#DirtyImager.get_dirty_beam_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.DirtyImager.get_dirty_beam_area" title="Link to this definition">#</a></dt>
<dd><p>Compute the effective area of the dirty beam for each channel. Assumes that the
beam has already been generated by running
<a class="reference internal" href="#mpol.gridding.DirtyImager.get_dirty_image" title="mpol.gridding.DirtyImager.get_dirty_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_dirty_image()</span></code></a>. This is an approximate
calculation involving a simple sum over all pixels out to the first null
(zero crossing) of the dirty beam. This quantity is designed to approximate the
conversion of image units from <span class="math notranslate nohighlight">\([\mathrm{Jy}\,\mathrm{beam}^{-1}]\)</span> to
<span class="math notranslate nohighlight">\([\mathrm{Jy}\,\mathrm{arcsec}^{-2}]\)</span>, even though units of
<span class="math notranslate nohighlight">\([\mathrm{Jy}\,\mathrm{dirty\;beam}^{-1}]\)</span> are technically undefined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ntheta</strong> (<em>int</em>) – number of azimuthal wedges to use for the 1st null
calculation. More wedges will result in a more accurate estimate of
dirty beam area, but will also take longer.</p></li>
<li><p><strong>single_channel_estimate</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (the default), use the area
estimated from the first channel for all channels in the multi-channel
image cube. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, calculate the beam area for all channels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(1D numpy array float) beam area for each channel in units of
<span class="math notranslate nohighlight">\([\mathrm{arcsec}^{2}]\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mpol.gridding.DirtyImager.get_dirty_image">
<span class="sig-name descname"><span class="pre">get_dirty_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weighting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">robust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Jy/beam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_visibility_scatter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_scatter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">beam_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">floating</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/mpol/gridding.html#DirtyImager.get_dirty_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mpol.gridding.DirtyImager.get_dirty_image" title="Link to this definition">#</a></dt>
<dd><p>Calculate the dirty image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weighting</strong> (<em>string</em>) – The type of cell averaging to perform. Choices of
<code class="docutils literal notranslate"><span class="pre">&quot;natural&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;uniform&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;briggs&quot;</span></code>, following CASA tclean.
If <code class="docutils literal notranslate"><span class="pre">&quot;briggs&quot;</span></code>, also specify a robust value.</p></li>
<li><p><strong>robust</strong> (<em>float</em>) – If <code class="docutils literal notranslate"><span class="pre">weighting='briggs'</span></code>, specify a robust value in the
range [-2, 2]. <code class="docutils literal notranslate"><span class="pre">robust=-2</span></code> approxmately corresponds to uniform
weighting and <code class="docutils literal notranslate"><span class="pre">robust=2</span></code> approximately corresponds to natural
weighting.</p></li>
<li><p><strong>taper_function</strong> (<em>function reference</em>) – a function assumed to be of the form
<span class="math notranslate nohighlight">\(f(u,v)\)</span> which calculates a prefactor in the range <span class="math notranslate nohighlight">\([0,1]\)</span>
and premultiplies the visibility data. The function must assume that
<span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> will be supplied in units of
<span class="math notranslate nohighlight">\(\mathrm{k}\lambda\)</span>. By default no taper is applied.</p></li>
<li><p><strong>unit</strong> (<em>string</em>) – what unit should the image be in.
Default is <code class="docutils literal notranslate"><span class="pre">&quot;Jy/beam&quot;</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;Jy/arcsec^2&quot;</span></code>, then the effective area
of the dirty beam will be used to convert from <code class="docutils literal notranslate"><span class="pre">&quot;Jy/beam&quot;</span></code> to
<code class="docutils literal notranslate"><span class="pre">&quot;Jy/arcsec^2&quot;</span></code>.</p></li>
<li><p><strong>check_visibility_scatter</strong> (<em>bool</em>) – whether the routine should check the
standard deviation of visibilities in each within each <span class="math notranslate nohighlight">\(u,v\)</span> cell
(<span class="math notranslate nohighlight">\(\mathrm{cell}_{i,j}\)</span>) defined by <code class="docutils literal notranslate"><span class="pre">self.coords</span></code>. Default is
<code class="docutils literal notranslate"><span class="pre">True</span></code>. A <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code> will be raised if any cell has a scatter
larger than <code class="docutils literal notranslate"><span class="pre">max_scatter</span></code>.</p></li>
<li><p><strong>max_scatter</strong> (<em>float</em>) – the maximum allowable standard deviation of visibility
values in a given <span class="math notranslate nohighlight">\(u,v\)</span> cell (<span class="math notranslate nohighlight">\(\mathrm{cell}_{i,j}\)</span>) defined
by <code class="docutils literal notranslate"><span class="pre">self.coords</span></code>. Defaults to a factor of 120%.</p></li>
<li><p><strong>**beam_kwargs</strong> – all additional keyword arguments passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">get_dirty_beam_area()</span></code> if <code class="docutils literal notranslate"><span class="pre">unit=&quot;Jy/arcsec^2&quot;</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2-tuple of (<code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">beam</span></code>) where <code class="docutils literal notranslate"><span class="pre">image</span></code> is an (nchan, npix, npix)
numpy array of the dirty image cube in units <code class="docutils literal notranslate"><span class="pre">unit</span></code>. <code class="docutils literal notranslate"><span class="pre">beam</span></code> is an numpy
image cube with a dirty beam (PSF) for each channel. The units of the beam
are always Jy/{dirty beam}, i.e., the peak of the beam is normalized to 1.0.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="fourier.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fourier</p>
      </div>
    </a>
    <a class="right-next"
       href="images.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Images</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.verify_no_hermitian_pairs"><code class="docutils literal notranslate"><span class="pre">verify_no_hermitian_pairs()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.GridderBase"><code class="docutils literal notranslate"><span class="pre">GridderBase</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.GridderBase.ground_cube"><code class="docutils literal notranslate"><span class="pre">GridderBase.ground_cube</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DataAverager"><code class="docutils literal notranslate"><span class="pre">DataAverager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DataAverager.to_pytorch_dataset"><code class="docutils literal notranslate"><span class="pre">DataAverager.to_pytorch_dataset()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager"><code class="docutils literal notranslate"><span class="pre">DirtyImager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager.from_tensors"><code class="docutils literal notranslate"><span class="pre">DirtyImager.from_tensors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager.get_dirty_beam_area"><code class="docutils literal notranslate"><span class="pre">DirtyImager.get_dirty_beam_area()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mpol.gridding.DirtyImager.get_dirty_image"><code class="docutils literal notranslate"><span class="pre">DirtyImager.get_dirty_image()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ian Czekala
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2019-24, Ian Czekala.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>