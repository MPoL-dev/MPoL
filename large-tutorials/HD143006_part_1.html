

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HD143006 Tutorial Part 1 &mdash; MPoL 0.1.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="https://buttons.github.io/buttons.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <link rel="stylesheet" href="../_static/bullets.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/faculty.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans|Roboto:400,700|Roboto+Mono:400,700&display=swap" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HD143006 Tutorial Part 2" href="HD143006_part_2.html" />
    <link rel="prev" title="Initializing with the Dirty Image" href="../ci-tutorials/initializedirtyimage.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

  
    <a class="heading heading-extra-margin" href="../index.html">
      <div class="logo-box logo-box-large">
        <img class="logo" src="../_static/logo.png"/>
      </div>
      
        <span class="icon icon-home"> MPoL</span>
      
    </a>
  

  
    
    
      <div class="version">0.1.1</div>
    
  

  
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rml_intro.html">Introduction to Regularized Maximum Likelihood Imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">MPoL Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units-and-conventions.html">Units and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer-documentation.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ci-tutorials/PyTorch.html">Introduction to PyTorch: Tensors and Gradient Descent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci-tutorials/gridder.html">Gridding and diagnostic images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci-tutorials/optimization.html">Optimization Loop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci-tutorials/crossvalidation.html">Cross validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci-tutorials/gpu_setup.html">GPU Acceleration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ci-tutorials/initializedirtyimage.html">Initializing with the Dirty Image</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HD143006 Tutorial Part 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#viewing-the-clean-image">Viewing the CLEAN image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plotting-the-baselines">Plotting the Baselines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-mpol-gridder-object">The MPoL Gridder Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-diagnostic-dirty-images">Making diagnostic dirty images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-dirty-and-cleaned-images">Comparing Dirty and CLEANed Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="HD143006_part_2.html">HD143006 Tutorial Part 2</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MPoL</a>
        
      </nav>


      <div class="wy-nav-content">

  

  
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
  <li class="breadcrumb"><a href="../index.html">MPoL</a> &raquo;</li>
    
  <li class="breadcrumb">HD143006 Tutorial Part 1</li>

    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/large-tutorials/HD143006_part_1.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%matplotlib inline
%run notebook_setup
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ian/Documents/Research/Disks/RML/MPoL/docs/large-tutorials/notebook_setup.py:7: DeprecationWarning: `magic(...)` is deprecated since IPython 0.13 (warning added in 8.1), use run_line_magic(magic_name, parameter_s).
  get_ipython().magic(&#39;config InlineBackend.figure_format = &quot;retina&quot;&#39;)
</pre></div>
</div>
</div>
</details>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="hd143006-tutorial-part-1">
<h1>HD143006 Tutorial Part 1<a class="headerlink" href="#hd143006-tutorial-part-1" title="Permalink to this heading">¶</a></h1>
<p>This tutorial is the first of an eventual three part series covering a real world application of RML imaging to the HD 143006 protoplanetary disk dataset observed as part of the DSHARP survey (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJ...869L..41A/abstract">Andrews et al. 2018</a>). In this tutorial (Part 1), we’ll provide a brief introduction to the dataset itself, the MPoL package, and perform some brief diagnostic imaging to make sure we have the basics configured properly.</p>
<p><a class="reference internal" href="HD143006_part_2.html"><span class="doc std std-doc">Part 2</span></a> of the tutorial will demonstrate how to set up the optimization loop and to create an RML image.</p>
<section id="viewing-the-clean-image">
<h2>Viewing the CLEAN image<a class="headerlink" href="#viewing-the-clean-image" title="Permalink to this heading">¶</a></h2>
<p>Before we dig into RML imaging or the MPoL package, let’s get our bearings by looking at the fiducial image provided by the DSHARP survey, synthesized using the CLEAN algorithm. We can download the FITS file directly from the DSHARP survey page</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import matplotlib.pyplot as plt
import numpy as np
from astropy.io import fits
from astropy.utils.data import download_file
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fname = download_file(
    &quot;https://almascience.eso.org/almadata/lp/DSHARP/images/HD143006_continuum.fits&quot;,
    cache=True,
    pkgname=&quot;mpol&quot;,
)
</pre></div>
</div>
</div>
</div>
<p>The following commands load the FITS file and calculate the RA and DEC axes using information from the FITS header. For more information on reading FITS files in Python, please consult the <a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/index.html">astropy documentation</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>hdul = fits.open(fname)
hdu = hdul[0]
clean_img = np.squeeze(hdu.data)
header = hdu.header
hdul.close()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># get the number of pixels in each direction
nx = header[&quot;NAXIS1&quot;]
ny = header[&quot;NAXIS2&quot;]
# RA coordinates
CDELT1 = 3600 * header[&quot;CDELT1&quot;]  # Convert from units of degrees to arcsec

# DEC coordinates
CDELT2 = 3600 * header[&quot;CDELT2&quot;]  # [arcsec]

# calculate the RA and DEC pixel centers
RA = (np.arange(nx) - nx / 2) * CDELT1  # [arcsec]
DEC = (np.arange(ny) - ny / 2) * CDELT2  # [arcsec]

# matplotlib imshow extent needs to include extra half-pixels.
ext = (
    RA[0] - CDELT1 / 2,
    RA[-1] + CDELT1 / 2,
    DEC[0] - CDELT2 / 2,
    DEC[-1] + CDELT2 / 2,
)  # [arcsec]
</pre></div>
</div>
</div>
</div>
<p>Here is the CLEAN image produced by the DSHARP team (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018ApJ...869L..41A/abstract">Andrews et al. 2018</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.imshow(clean_img, origin=&quot;lower&quot;, extent=ext)
# zooming in a little to focus on the disk
r = 0.8
plt.xlim(left=r, right=-r)
plt.ylim(top=r, bottom=-r)
# axis labels
plt.xlabel(r&quot;$\Delta \alpha \cos \delta$ [${}^{\prime\prime}$]&quot;)
plt.ylabel(r&quot;$\Delta \delta$ [${}^{\prime\prime}$]&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;$\\Delta \\delta$ [${}^{\\prime\\prime}$]&#39;)
</pre></div>
</div>
<img alt="../_images/519d33eac463f0e21b96735ed6fe8c4715d61332e7600b2369a2a83040aa547a.png" src="../_images/519d33eac463f0e21b96735ed6fe8c4715d61332e7600b2369a2a83040aa547a.png" />
</div>
</div>
</section>
<section id="plotting-the-baselines">
<h2>Plotting the Baselines<a class="headerlink" href="#plotting-the-baselines" title="Permalink to this heading">¶</a></h2>
<p>Now that we have an idea of what we’re looking to image, let’s load up the actual dataset. First, we’ll download the raw visibilities. To speed things along for the purpose of this tutorial (and avoid introducing CASA as a package dependency), we’ve already extracted the visibility data as a <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file, which we’ve made available on Zenodo.</p>
<p>More information on how to do this extraction in general is available on the <a class="reference external" href="https://mpol-dev.github.io/visread/">visread</a> documentation page, and the specific commands used to produce this <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file are available in the <a class="reference external" href="https://github.com/MPoL-dev/mpoldatasets/tree/main/products/HD143006-DSHARP-continuum">mpoldatasets</a> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fname = download_file(
    &quot;https://zenodo.org/record/4904794/files/HD143006_continuum.npz&quot;,
    cache=True,
    pkgname=&quot;mpol&quot;,
)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># load extracted visibilities from npz file
d = np.load(fname)
uu = d[&quot;uu&quot;]
vv = d[&quot;vv&quot;]
weight = d[&quot;weight&quot;]
data = d[&quot;data&quot;]
</pre></div>
</div>
</div>
</div>
<p>To get an idea of the <span class="math notranslate nohighlight">\(u,v\)</span> coverage of the dataset, let’s plot the <span class="math notranslate nohighlight">\(u,v\)</span> coordinates of the visibilities, as we’ve done in the <a class="reference external" href="https://mpol-dev.github.io/MPoL/ci-tutorials/crossvalidation.html">cross-validation tutorial</a> and the <a class="reference external" href="https://mpol-dev.github.io/visread/tutorials/introduction_to_casatools.html#Get-the-baselines">visread documentation</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(nrows=1)
ax.scatter(uu, vv, s=0.5, rasterized=True, linewidths=0.0, c=&quot;k&quot;)
ax.scatter(-uu, -vv, s=0.5, rasterized=True, linewidths=0.0, c=&quot;k&quot;)
ax.set_xlabel(r&quot;$u$ [k$\lambda$]&quot;)
ax.set_ylabel(r&quot;$v$ [k$\lambda$]&quot;)
ax.set_aspect(&quot;equal&quot;)
ax.set_title(&quot;Baselines&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Baselines&#39;)
</pre></div>
</div>
<img alt="../_images/566e158fa8ec839533def1206bb0e5498e1cbb523aec3e44cb0d27a8702b98a0.png" src="../_images/566e158fa8ec839533def1206bb0e5498e1cbb523aec3e44cb0d27a8702b98a0.png" />
</div>
</div>
<p>As you can see, there is a very dense grouping of visibilities with <span class="math notranslate nohighlight">\(q &lt; 2000\, \mathrm{k}\lambda\)</span>, where <span class="math notranslate nohighlight">\(q=\sqrt{u^2 + v^2}\)</span>, which primarily consists of data taken in more compact ALMA configurations. There are also several visibilities with baselines &gt; 7,000 (<span class="math notranslate nohighlight">\(k\lambda\)</span>), which correspond to the extended ALMA configurations and is the reason why the DSHARP data can generate some of the highest spatial resolution images of protoplanetary disks to date.</p>
</section>
<section id="the-mpol-gridder-object">
<h2>The MPoL Gridder Object<a class="headerlink" href="#the-mpol-gridder-object" title="Permalink to this heading">¶</a></h2>
<p>Though we have lofty ambitions to make RML images with these DSHARP visibilities, our first goals are much humbler (and pragmatic). Basically, we want to make sure that we are loading the visibilities into MPoL correctly with the right units and in the right format.</p>
<p>One of the simplest ways to do that is by instantiating an MPoL <a class="reference external" href="https://mpol-dev.github.io/MPoL/api.html#mpol.gridding.Gridder">Gridder</a> object, which can perform basic visibility averaging and inverse Fourier transforms as implemented in CASA. This allows us to check that we’re starting from the same basic understanding of the data by creating our own version of a dirty image.</p>
<p>To instantiate an MPoL Gridder object, we need to make a choice for the size of the pixels <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> and the number of pixels per side of our image, <code class="docutils literal notranslate"><span class="pre">npix</span></code>. You can read more about these properties in the <a class="reference external" href="https://mpol-dev.github.io/MPoL/api.html#mpol.coordinates.GridCoords">GridCoords</a> API Documentation.</p>
<p>We’ll follow the CLEAN example and use the same <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> provided in the FITS image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cell_size = np.abs(header[&quot;CDELT1&quot;] * 3600)  # [arcsec]
print(&quot;cell_size is {:.4f} arcseconds&quot;.format(cell_size))
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cell_size is 0.0030 arcseconds
</pre></div>
</div>
</div>
</div>
<p>The FITS image was a full 3000x3000 pixels. In general, it is good practice to synthesize an image the full size of the primary beam to avoid potential aliasing from bright sources at the edge of your field, or at least once to check that no bright sources exist in the field of view. That appears to be the rationale of the FITS images provided by the DSHARP team.</p>
<p>Since the DSHARP team has already checked there are no bright sub-mm sources in the FOV, we can save time and just make a smaller image corresponding to the protoplanetary emission. If <code class="docutils literal notranslate"><span class="pre">cell_size</span></code> is 0.003 arcseconds, <code class="docutils literal notranslate"><span class="pre">npix=512</span></code> pixels should be sufficient to make an image approximately 1.5 arcseconds on a side. Now, let’s import the relevant MPoL routines and instantiate the Gridder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from mpol import gridding

gridder = gridding.Gridder(
    cell_size=cell_size,
    npix=512,
    uu=uu,
    vv=vv,
    weight=weight,
    data_re=data.real,  # separating the real and imaginary values of our data
    data_im=data.imag,
)
</pre></div>
</div>
</div>
</div>
</section>
<section id="making-diagnostic-dirty-images">
<h2>Making diagnostic dirty images<a class="headerlink" href="#making-diagnostic-dirty-images" title="Permalink to this heading">¶</a></h2>
<p>Now, we’ll use the <a class="reference internal" href="../api.html#mpol.gridding.Gridder.get_dirty_image" title="mpol.gridding.Gridder.get_dirty_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mpol.gridding.Gridder.get_dirty_image()</span></code></a> routine to average the visibilities to the grid defined by gridder, and perform an inverse Fourier transform to get the dirty image.</p>
<p>There are different ways to weight the visibilities during the averaging process to promote certain image characteristics. More info on the weighting can be found in the <a class="reference external" href="https://casa.nrao.edu/casadocs-devel/stable/imaging/synthesis-imaging/data-weighting">CASA documentation</a>. The MPoL gridder is capable of averaging visibilities using uniform, natural, and Briggs robust weighting. We’ll demonstrate this functionality by making several different dirty images under different averaging schemes.</p>
<p>We’ll write a function to calculate the dirty image and then plot it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def image_and_plot(weighting, robust=None):

    img, beam = gridder.get_dirty_image(
        weighting=weighting, robust=robust, unit=&quot;Jy/arcsec^2&quot;
    )

    kw = {&quot;origin&quot;: &quot;lower&quot;, &quot;extent&quot;: gridder.coords.img_ext}
    fig, ax = plt.subplots(ncols=1)
    im = ax.imshow(np.squeeze(img), **kw)
    cbar = plt.colorbar(im)
    cbar.set_label(r&quot;$\mathrm{Jy}/\mathrm{arcsec}^2$&quot;)

    title = weighting
    if robust is not None:
        title += &quot; r={:.1f}&quot;.format(robust)
    ax.set_title(title)
    ax.set_xlabel(r&quot;$\Delta \alpha \cos \delta$ [${}^{\prime\prime}$]&quot;)
    ax.set_ylabel(r&quot;$\Delta \delta$ [${}^{\prime\prime}$]&quot;)
    r = 0.7
    plt.xlim(left=r, right=-r)
    plt.ylim(bottom=-r, top=r)

    return np.squeeze(img)
</pre></div>
</div>
</div>
</div>
<p>Uniform weighting frequently produces images with the best spatial resolution, but at the expense of sensitivity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_ = image_and_plot(weighting=&quot;uniform&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a1efa2a62a58ea0257a35fa70bd08c9d7ced2fa741ffca81380f48b064e96e4d.png" src="../_images/a1efa2a62a58ea0257a35fa70bd08c9d7ced2fa741ffca81380f48b064e96e4d.png" />
</div>
</div>
<p>Natural weighting frequently produces images with the best sensitivity to point sources, but at the expense of spatial resolution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_ = image_and_plot(weighting=&quot;natural&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/92188645c412bd593685cc1fa2ca97475b4183e964247646097483798e429bae.png" src="../_images/92188645c412bd593685cc1fa2ca97475b4183e964247646097483798e429bae.png" />
</div>
</div>
<p>Robust weigting provides a (nonlinear) tradeoff between these two regimes, and some form of robust weighting is typically chosen for ALMA imaging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_ = image_and_plot(weighting=&quot;briggs&quot;, robust=-1.0)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02ecbdbe8763512ee8bbecb2e5aa9ec9a6ae151ea777712921d9a47596800c56.png" src="../_images/02ecbdbe8763512ee8bbecb2e5aa9ec9a6ae151ea777712921d9a47596800c56.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>img_robust_0 = image_and_plot(weighting=&quot;briggs&quot;, robust=0.0)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3fc7b8fbd18620e9f860000ce3229839ca5815a0b88eef744a6a28f9536a4021.png" src="../_images/3fc7b8fbd18620e9f860000ce3229839ca5815a0b88eef744a6a28f9536a4021.png" />
</div>
</div>
</section>
<section id="comparing-dirty-and-cleaned-images">
<h2>Comparing Dirty and CLEANed Images<a class="headerlink" href="#comparing-dirty-and-cleaned-images" title="Permalink to this heading">¶</a></h2>
<p>All in all, it looks like our diagnostic dirty images produced by the MPoL gridder look similar enough in scale and orientation to the DSHARP CLEAN image that we have some confidence that we’re reading in the visibility data correctly.</p>
<p>To wrap things up, let’s directly compare a dirty image with the DSHARP CLEAN image, which was produced using robust=0.0. (A slight <span class="math notranslate nohighlight">\(u,v\)</span> taper was also used, but we’ll ignore that detail here).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, ax = plt.subplots(ncols=2, figsize=(5.5, 3))

ax[0].imshow(clean_img, origin=&quot;lower&quot;, extent=ext)
ax[0].set_title(&quot;DSHARP CLEAN&quot;)

ax[1].imshow(img_robust_0, origin=&quot;lower&quot;, extent=gridder.coords.img_ext)
ax[1].set_title(&quot;MPoL Dirty&quot;)

for a in ax:
    r = 0.7
    a.set_xlim(left=r, right=-r)
    a.set_ylim(bottom=-r, top=r)

    a.xaxis.set_visible(False)
    a.yaxis.set_visible(False)

fig.subplots_adjust()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/79a635fad4a8ac8580c9742125065d21fc61ae20958bb1c34dc6875479d2d25d.png" src="../_images/79a635fad4a8ac8580c9742125065d21fc61ae20958bb1c34dc6875479d2d25d.png" />
</div>
</div>
<p>All in all, it seems like we’re on the right track. The diagnostic dirty image that we’ve produced with the MPoL gridder object is approximately the same size and orientation as the DSHARP CLEAN image, and it retains many of the same morphological features as well. Of course, the dirty image is noisier because it still contains the sidelobe response of the dirty beam—it hasn’t been CLEANed yet!</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="HD143006_part_2.html" class="btn btn-neutral float-right" title="HD143006 Tutorial Part 2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../ci-tutorials/initializedirtyimage.html" class="btn btn-neutral float-left" title="Initializing with the Dirty Image" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-21, Ian Czekala

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>


      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-5472810-8', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>